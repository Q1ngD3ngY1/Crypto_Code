import math
import paillier_variant
import random
import System_Params
import time
import Worker_1
import Worker_2
import Worker_3
import Worker_4
import Worker_5





'''----------------------------参数和数据部分--------------------------------------------'''
#AES加密的对称密钥
symmetric_key = 'woshililinhahaha'.encode()

#群阶
q = 115792089237316195423570985008687907852837564279074904382605163141518161494337

#用户列表
U_ID = [1,2,3,4,5]

#任务列表
Mission = [1,2,3,4,5]

#paillier加密的公钥
paillier_public_key = paillier_variant.public_key

#用户数据部分

aes_enc_perbed_data_1,aes_enc_pai_enc_task_data_1,aes_enc_pai_enc_perb_1,aes_enc_pai_enc_perbpowsum_1,H_j_1,mac_1 = Worker_1.main()
aes_enc_perbed_data_2,aes_enc_pai_enc_task_data_2,aes_enc_pai_enc_perb_2,aes_enc_pai_enc_perbpowsum_2,H_j_2,mac_2 = Worker_2.main()
aes_enc_perbed_data_3,aes_enc_pai_enc_task_data_3,aes_enc_pai_enc_perb_3,aes_enc_pai_enc_perbpowsum_3,H_j_3,mac_3 = Worker_3.main()
aes_enc_perbed_data_4,aes_enc_pai_enc_task_data_4,aes_enc_pai_enc_perb_4,aes_enc_pai_enc_perbpowsum_4,H_j_4,mac_4 = Worker_4.main()
aes_enc_perbed_data_5,aes_enc_pai_enc_task_data_5,aes_enc_pai_enc_perb_5,aes_enc_pai_enc_perbpowsum_5,H_j_5,mac_5 = Worker_5.main()

aes_enc_perbed_data = [aes_enc_perbed_data_1,                   #二维列表,用于存储所有用户的AES加密后的扰动的数据
                       aes_enc_perbed_data_2,
                       aes_enc_perbed_data_3,
                       aes_enc_perbed_data_4,
                       aes_enc_perbed_data_5]                            
aes_enc_pai_enc_task_data = [aes_enc_pai_enc_task_data_1,       #二维列表,用于存储所有用户的AES加密后的paillier加密的原始感知数据
                             aes_enc_pai_enc_task_data_2,
                             aes_enc_pai_enc_task_data_3,
                             aes_enc_pai_enc_task_data_4,
                             aes_enc_pai_enc_task_data_5]                      
aes_enc_pai_enc_perb = [aes_enc_pai_enc_perb_1,                 #二维列表,用于存储所有用户的AES加密后的paillier加密的扰动
                        aes_enc_pai_enc_perb_2,
                        aes_enc_pai_enc_perb_3,
                        aes_enc_pai_enc_perb_4,
                        aes_enc_pai_enc_perb_5]                           
aes_enc_pai_enc_perbpowsum = [aes_enc_pai_enc_perbpowsum_1,     #一维列表,用于存储所有用户的AES加密后的paillier加密的扰动的平方和
                              aes_enc_pai_enc_perbpowsum_2,
                              aes_enc_pai_enc_perbpowsum_3,
                              aes_enc_pai_enc_perbpowsum_4,
                              aes_enc_pai_enc_perbpowsum_5]                     
H_j = [H_j_1,H_j_2,H_j_3,H_j_4,H_j_5]                           #一维列表,用于存储所有用户的身份验证信息

mac = [mac_1,mac_2,mac_3,mac_4,mac_5]                           #一维列表,用于存储所有用户的消息认证码信息

z_k = [13180131810,17844599179,1234567890,12345678911,12345678912]

#身份验证信息
H_j_1 = [Worker_1.H_1j_1,Worker_2.H_2j_1,Worker_3.H_3j_1,Worker_4.H_4j_1,Worker_5.H_5j_1]

#初始化每个任务的真值
X_star = [3970,50,125,60,1974]
#X_star = [2500,40,125,30,1400]

#B = 81865220522310876359821923958014629473482453552683504256598581056589131611406
#b_k = [42130861376655068110503503409436748599403846380938846605487325203446551579924, 68939818965071087917339240837522460981164224612940224838126641356938398896110, 71286814059306956989906697515358610266576225553176620266040834870075009686107, 12749368644171140068734795603323589148150935550801266549502942456294820029674, 5244731935645384263583014494452441403745666892541197230589487285682909199124]
B = 100
b_k = [11,23,35,44,52]

pai = paillier_variant.Paillier()


'''----------------------------函数部分-------------------------------------------------------'''
#消息完整性检验函数
def message_integrity_check(s,zk,local_mac):
    #s = str(aes_enc_perbed_data[0]) + str(aes_enc_pai_enc_task_data[0]) + str(aes_enc_pai_enc_perb[0]) + str(aes_enc_pai_enc_perbpowsum[0]) + str(H_j[0])
    mac_p = System_Params.MAC(s,zk)
    if mac_p == local_mac:
        return 1
    else:
        return 0


#身份和数据完整性检测函数
def check():

    #验证感知用户身份
    print('Identity Verifing...')
    for k in range(len(U_ID)):
        if System_Params.Identity_check(H_j_1[k],H_j[k]) == 1:
            print("%d user's identity is correct.\n"%(k+1))
        else:
            print("%d user's identity is error.\n"%(k+1))
    
    #数据完整性检测
    print("Data Integrity Checking...")
    for k in range(len(U_ID)):
        s = str(aes_enc_perbed_data[k]) + str(aes_enc_pai_enc_task_data[k]) + str(aes_enc_pai_enc_perb[k]) + str(aes_enc_pai_enc_perbpowsum[k]) + str(H_j[k])
        if message_integrity_check(s,z_k[k],mac[k]) == 1:
            print("%d user's data is complete.\n"%(k+1))
        else :
            print("%d user's data is not complete.\n"%(k+1))
    

#解密AES加密的数据
def Decrypt_aes_en():
    perbed_data = [[],[],[],[],[]]
    pai_enc_task_data = [[],[],[],[],[]]
    pai_enc_perb = [[],[],[],[],[]]
    pai_enc_perbpowsum = []

    #获取每个用户被扰动的数据
    for k in range(len(U_ID)):
        for m in range(len(Mission)):
            perbed_data[k].append(System_Params.aes_decrypt(symmetric_key,aes_enc_perbed_data[k][m]))
    
    #获取每个用户的paillier加密的原始感知数据
    for k in range(len(U_ID)):
        for m in range(len(Mission)):
            pai_enc_task_data[k].append(System_Params.aes_decrypt(symmetric_key,aes_enc_pai_enc_task_data[k][m]))
    
    #获取每个用户的paillier加密的扰动
    for k in range(len(U_ID)):
        for m in range(len(Mission)):
            pai_enc_perb[k].append(System_Params.aes_decrypt(symmetric_key,aes_enc_pai_enc_perb[k][m]))
    
    #获取每个用户的paillier加密的扰动的平方和
    for k in range(len(U_ID)):
        pai_enc_perbpowsum.append(System_Params.aes_decrypt(symmetric_key,aes_enc_pai_enc_perbpowsum[k]))
    return perbed_data,pai_enc_task_data,pai_enc_perb,pai_enc_perbpowsum

perbed_data,pai_enc_task_data,pai_enc_perb,pai_enc_perbpowsum = Decrypt_aes_en()
#print('pai_enc_perb:\n')
#print(pai_enc_perb)

#权值更新辅助函数Step Q1
def weight_update_auxi():
    dist_auxi = [[],[],[],[],[]]
    for k in range(len(U_ID)):
        for m in range(len(Mission)):
            dist_auxi[k].append(perbed_data[k][m] - X_star[m])
    
    #计算C_distcon_k
    C_distcon_k = []
    for k in range(len(U_ID)):
        pai = paillier_variant.Paillier()
        c = 1
        for m in range(len(Mission)):
            c = pai.homomorphic_addition(c,pai.scalar_exponentiation(pai_enc_perb[k][m],2*dist_auxi[k][m],paillier_public_key[0]),paillier_public_key[0])
        c = pai.homomorphic_addition(c,pai_enc_perbpowsum[k],paillier_public_key[0])
        C_distcon_k.append(c)
    
    
    Aggre_C_distcon = 1
    pai = paillier_variant.Paillier()
    for k in range(len(U_ID)):
        Aggre_C_distcon = pai.homomorphic_addition(Aggre_C_distcon,C_distcon_k[k],paillier_public_key[0])
    Aggre_B_C_distcon = pai.scalar_exponentiation(Aggre_C_distcon,B,paillier_public_key[0])             #---------------
    B_sum_dist_auxi = 0
    for k in range(len(U_ID)):
        for m in range(len(Mission)):
            B_sum_dist_auxi += dist_auxi[k][m] ** 2
    B_sum_dist_auxi = B_sum_dist_auxi * B                                                               #---------------

    
    b_sum_dist_auxi = []                                                                                #---------------
    for k in range(len(U_ID)):
        b_sum_k = 0
        for m in range(len(Mission)):
            b_sum_k += dist_auxi[k][m] ** 2
        b_sum_dist_auxi.append(b_sum_k * b_k[k])
    b_C_distcon_k = []                                                                                  #---------------
    for k in range(len(U_ID)):
        b_C_distcon_k.append(pai.scalar_exponentiation(C_distcon_k[k],b_k[k],paillier_public_key[0]))
    return B_sum_dist_auxi,Aggre_B_C_distcon,b_sum_dist_auxi,b_C_distcon_k
'''
B_sum_dist_auxi,Aggre_B_C_distcon,b_sum_dist_auxi,b_C_distcon_k = weight_update_auxi()
print('B_sum_dist_auxi:\n')
print(B_sum_dist_auxi,'\n')
print('Aggre_B_C_distcon:\n')
print(Aggre_B_C_distcon,'\n')
print('b_sum_dist_auxi:\n')
print(b_sum_dist_auxi,'\n')
print('b_C_distcon_k:\n')
print(b_C_distcon_k,'\n')
'''


ck_Bk_weight = [89, 189, 15, 201, 83]
pai_enc_ck = [1275630096197312253478994843074303180716493758491888068746924644519416328331870118585801593160164285649316286149579971629653446706276090503913968419993087386523289692744201793360203143645217577869392900012190686581377078603641168480158177028203784188085810259121854886573693856729115097563726644006975540849880719464884007361758328831630014415430176569725253848231318445650643048314394999700206934644835159007552051089259797733192759422131796638503987821365155105855435466572525371186546323484375706051470633768396759050801186565610839770687309736279918235365511504586626876256710259029621682017650206168464994936263752021290897261579233912410936534596966857328613258321504385823973181199266294225418204578953305852024696656711299709618826259809458026173150417082623953647977654310867708483876546720643616322945581816993220081704411562526900840209891000390015497698024340211440428916988597399645907853660563219480450077702868942784483044353526066299449491383337441830890603043689512013243482684441965841070198953520427986811348183086069201675880075787152331882093625142218623266953810616597681197580926384424245156779805010654628214013793309385804456664266376058573830277580960027973035226848387691825465902656635945718685401968400527062075935672243668576124652063166271722370026969602129735609773249513503805798762064309578763672300828176014283747170233793789665656990332732891294122186631396898844009479852647716249017083776708187473609659038180822977514503482758583328454943563535983099963059486814430289677719333461020657873502109035667833749997018173478128468416816962391660703575454015597022261413832418122770199193822204707056112468893928065911731374239341459766463809834608091948007767301681803953633273287690908023115363712888464471933437880062752801824933701061146000640533386200624639239984508480908672225195268326492473263960227980523031749145165717127789408346674138635254441773738800834121201125624622796397091413239970481663647837101865013193883810335309554779349353107552967717813847701869016360425415435680935191023485421397129621207902217043936341483595292059585272402391552072937244997719415481963343910030980240571577542511313745840102903539953466861032118095612955804372677028663787597943810712068227866439942653879372687687534676181815465193482261516900264343639676193604303766330509740671822016573882912100666588718794505582636697626782990123581317412469866616029919707142762482752429674548850029990856668598441991608758010179044855002902900884196313268457536543832919973269398768382967027103979652890329991924469474391399743960916001268494066805680463433243765878415040323285377206420148599927412571961717156376028930122355993284120151355461269775835197555564860859454301439883130226442249917965358090168004277236692237254194695141735344383396185100648521930511104064462886967070754821205461086979160414943393709525077514650808090147275136496659296980067895937229822722783030541978869284156140397923288453197576621453884332758203603646923676708210970481066982955454429872334414073275793882788366464037738609077610142130670068307438801870486969097196655804889918359328106710023128246151378649096238735627186224801798902780431280989607018359531397977387935998251662078702456746034924038774071725944206014579788936997113040758792725094469906228838209582552153261185560987063929607424409062802299544325682152790623375153789602274380003779195558397577304034940891353569905916018581681727345920980461145021890263107782839754907380382327814145717512364328126168796773388257122741717107077231310045491657759479709696256360273127829681941344896825864995891217622853271005447869492072954447008270722250212163983192447596868606762180428787113863459244449582768122614163555122636979186,
              5550406589961391298325591038654102724508172020830030363868283964707055565645567473942478941703639115181437628420418801610808891510410879328115965923252589710097431694963068496333506596443597855682284043138643368679960265504566258187260507176450981061746841153523124560363035876995991772228679148513370030065231662986239180406438993009343021300720778149804805062107692799990097351571678394757038556377592250687791665877060721236597379616207323077746367405796387773885640805284009638207450161813193524571751915314124087165766348765051295577842227744479037981369368453483166231757594103083358788601714715700648435714175083704018970547999824474274606679443083207738698064780942777341309099450012887638517183640242411800945219913165825507070999895148399580406418023894454485796786794757071692101783092241036938106462568151401482181993579190422740345942661985833106284652178748151548908420797387758478535436863475327004346877305471990639184813221867293255809886268249281838022793056275343699287640999092914125386006219084999519076832084868975866175723487837248129901793367004083063279057735390082354232142577791425351397463561495084642831141683883605047444141880324609184281373364795894419363212850853625336823474918320543257078852195168563584616580874455617790341924346565736578944229342278853164802324728584571754191567897360910218082048494451935962979490965945990431893021258546212850541401424556088406055399301867761002491343793318076499264097158667643370624296578557340799472470932589807408443128669312715156873293676851164919888721332012307704393890227732581661469953629777957502381600656032031492248233100187358895317234290990181481268273834917774659989087196319292886994610941886593596394856944050363543228086545985306833263883799306516402713175821105849842294896751137966765870218636623402528930138165444622714672845241357690791539091788041327258920768203866487065417173228177179389788993030168345555206338926587736043250784139806072458300525245392229655761527201444745949132441786190788208904593889838002234516923038299773711588849441116136191542168490343254575314943073529711655992465850624999130962779822934696519268453691296568018146698693803406755345997050831725621403893465171375968485165694986062828364847346974805058914283301018673991249374322976907212775054833101593064148960731185639986445696638091740845724230601324883521488736835272930991860399044716945805234168264580812826501585859593794160931125045068607818571351444165914714578701054915617710246288150530772370220770647583315965231563657434847514050731520776847612602007891235371126353392410039228314280384568984547366202002088336618347367483514545429993685669020805301969852332521551868531089356212406573522381986480965848448075845008182269216518036335792734663240876792498692466321268717176533946955901501587395629013842820160890023593511842314074169803714435550132430232570401946907359060900890756632392883587363071057897666551526947192665966605563031587089184529679319699110593115980970513040594697889244917794994884622305536148810313586179534305497059321351519971290471676237817074474375928648110467427781631878570695915192180504390084515849720675315783418405209279636037607183790976306349373717746569911881050194339974378963678889063770908083412386500722232811207776692964904285317183749022164595370502081814204742767675708385076046956548240645208217389103251162050310801145719993176700516662444131849228818563154042935119631996443844019909868874320647707924224588672995092157497998418636351981565811433064897271894173417354582031500927694392808141970627900845137066817587783220001532485894752470916169008002357103197641744928380886406229081920997065637842164308718805066067871928156917924424550465430710622172590603613272,
              3446702390826153769624971616518829048699853137680132880490125836467661098218841132869355046768325419175085825436692273865439010962713989982212572069026563295320474319750019933823152504997345741670653503878608499166299256418989069787902757481482025883503128015145711747757195733789441118709727560800579421222513023796385228902650371791831986292342608068165779309277759237709432224050397796432600899174841666020399935460974236050220794438268958558633306183444867153243093299543631043693782670269152524089655573038386238655742028401135957637355979059050434595835772717799726744439926679243041104828531220636513113518325571604439714046891454877785650290041971102640263522190810298892772083764031203501621383313042607842797609203466722800962431321093509926417519733958808227153217278235148674914702709496953917887780982945462834459131285878108947544926536571796311916894351760600722232040560317364104915615654246388850046259729374583049747151085335483730746276976890160489743379745503500505784862379704474912245463752702207608657145131584883359421230561642961250329686724508585682132014420080552032932642059017903813811334673421561474786232434567490262465088162616852682739897569385291467589869097711054864189913843125842746587729646320457963787691798460260220394808465039342614938817746266903738807883033457596257239994576605410181077129241640040218391413525816755495470015805026413366734689736754134094970472147174563984954825438420298126070774324980527517586450109335305484986860466066711893681864027841712030129328559063179227818159072688496470733304614992562411634558930970365063148604944845234751056016145933390810153450128823156803852177638901218489399304070942092933784583678370559607936725580796033806782651350245477267029902870996319161816635121517550545644942524726196936094924735300926352907995243962654086281697823644544859878675550410940560590521460177511042210347207951930323847643505942463141956812531096275181385616575315559144011359408886502626298663520336268044009001369955418215012806355378780638184598543235615546841797086123970137651720008767779541532299880725424589770637395881773141331398995395518919645286714874630582042939935074405101950896823038520207350104456074594070188673632387112727576928075692705379572536381063544068677543923843338389066167490298706908666012072778865298426615014364662628185748006135563055585441368994868338635823723507424436429670336628387544846055675725418658575352209304812460265526846307773493677276803174569120958796299761522366296179944202759153939134362814161988848479851176392216170109426377934273822530006062785916595504413564747572012919752131613256669729375238121185773180150655278042556933358337163702657057608008044500643795446286014945451024967280696254626755809834582707378294722237128231605036067431048320206302456633686415546410070617711315629957195960050914442656279123568034769508859348210030106146389644349832123080180021190934925785198256340811796794913639754975566181207468305636846800236585677191328318769487720865911059578206156978071773751002151126707606969157633026991595176721951902559285043385726282404280491682539124990890087777655338178604229177407663545198609579486832739108557719021307620021102863312717485639879655545057792220895977416417820451379975500818214538098428345827523814760018137954400032073379669663679891382533118114611081319704243999384154416855072990565678474353276496892623474237087705974773161936043512263318533952928982365127452056242564463811808687313545802660814679168277030478087453899839588175103763697750447776075045536139771552784593969725997839255552675420382960083649556117392214330413868850559811940351402892465240597793597236392842157161716750811731515120745713806500644766667013574542884425,
              5589013805807431093498334268448549181203431587321661791841775572566304464910395650308209623617161052847467360388594389429721411375709210094412298751970454953758931751269490249404196077848195895180957972747413348746061023771743430002605293219163733652803635347701252495960104831417540790233872343210451678413915806298132502199175890611933789168785673193883942833409593174553321214926420281061127282702067520099095183965390732588069412665257142091806770287029625769320000155309086587982480157520302727814299349594265941799495589498790428481530882791748543421284275606044423461671056248791086518125200763862536861781301062079164855566288072844053380045272756302340109890271762103012054457134883774576914851160113408034139278874647912996005088044160096936513828930483759784403065800673095361095892676999461025508940488805536319719517758235634059659542957772093847270238077299560841387301063422488953101004307403179469517651593222597349729612691396246073703950124856574518946963380367256495276377792576057252779557156355290038440900064532792517249699523266096027976717557763960671626332416311664359338581387419927419543527814973491619517225810656784173697481357984249993826573117921017593210482395182664265067644738959843403660591651849043095578603521035086210367434833640894228098712739037800228951091503437370608857690543197671733301756355854046460322152647050731081886020580428023719290325519706900022356042377848660915839070690205706181904444961166897066290368071783079262813510101109568760538151901515821939213071655324883350012689427123401359825559671743991253296892842883973786946481600186955311189163418535032781112976249289479021204918366253134725801508563239495505131641022338028236503023170158883729562156143281588209947665455555827821201866558671640085477442732155715934858789205363928511297401053552121049125010675524422811573441161924274808671905216457588272554751208433045214475508893666274755171774326068665945545040924566491771675828243342704209164642587195177462584422663130027600811994778001887258702778082811207315169330494753838488184986330760484745927698375511695627834210824676214938339775574361959688825296621884758102446902988578502342837969343855966756535214040486136092011953660684059313361540009698660375752822041341883344297016591866024077087973462152804306039081794261545888403834566009300716888774083628769177645140613155474612990901877988727724221993614459882642083718501262809730524570374259622384605147855635367541860467275280010128515830333774130060304192214006376723364829459869510000440321738171133212717584858384703085800049855858677117637728853408418660228894012864511350732073727629753703413405111430626941558549046248692597416683724891498394127831812989110785720005330703763547425021839212060672287653854278789419857129683550320751508968041168525351200462565909283114459009723844743618735453490409347649193456602157022108496239002861862627749688403533153279312370932310283107284804051595166761657428429192744950064915078368101286056637531622531187570183932808094823010678754636268109730024391851217030098269724968019164439678743215833886713537557703271384523124457933436866190591411040342847867457605035308184861861645163519079355753897161461764427169002308699063564093196888041134648137768005542070355715235480013484699956636462036760728863850148844684569199199987124799622035352851150492282282053435797243326235789566131720285361760128284111923750032322551194823030955931456317294428747028932182379890368786532736088906643615729222510934887957421573742328127485552060848506572803279891892462002258436735772866732941164616587749925626747603630933287105864066383783956080891438286234415304761611570631318493908720952935110291817240310944436858207634554218718685,
             10008372826757193716135774274926493830560669478681414271275161172181291803213994031606777894660527195231065902899170169539117579619181670583602171707473137258676301117893970036471473763361648301780827039697788934048106895936793576248784026211145722225751859248105222089521246494381290868536260566191822735856548701584921588866433771737519268658740326278923269298106275507797347293107909647134092664411031072947397988885479631925069548795631103960186212773655525854964034521301451832547012842504074770375764096694528610276835754637318930022245531531828587022054612337593137657864413380633380822793934889122409951079676657995754259173489011514360354287822110982166234068992012580491142977634155367006116543668034004482073221891122934156560474464751595449217389377414738928626103060353704631945764172068929803443567132370745223549419864957220791696176840487427922079802529243157989951308738931878820247663182625223139051564221735091301347425094072986572085649025176597198500857432179059072336610770067361649917188629259430320860629920858054134888352565835409661021752138016450006051002997082737073021581271943890693144766058752119266033831346719351342221008105785119830736212601021790930014305982487468199004006753218237752628725921049863920926161066627206338958768611537351311545261085885242363644844621031153221072400859462857598550828905586319324295962593306144041498070168778689602013179920722993756879313118864156214410007807405186852107371139764813537766404311388000502559422243210549052165807447976598984795846063476637350149939544651245944655513753404979003283055497111953160966302470156078406660228682260916632612972779124973596557624918870160012762210960281167076047248870765832836577272180604383808529051462983289451144307084270160037945642516712816059482552341521316143744713041045583903367948300730608546142346654493991624871570554551004965856931830560557192433908236571367002660280154945391196614018937977483318721961164777485359153478853286632180800579728749467018807680941813407379024713861349185862592854386943435233966915931482924114358257595042631487250618156807342206254192460396318345761126237043597179409493952329256280048168820785823515916627669047767377261872877353235734088819529279081850887357350076048888689664525370014812678036613700004196881622667052111919871995678762480756512320969230101682441591236306333423691241895745025137269989011299977800232045254242737523525809611086173327513067751191294723866597487206602667758195232647927401170738907157353257990307569418070008712093024433104742957156094652504996350008862639747630506422222635012946182499382898124635478436719612769457960415704419818350491803281239775109840136825748427832674531426325766743795983647888756749030609649855260218656573749539542096583324037838731400748640280471224208657504736554296604458393272867557785940277467904010387163414271587495106499217419657491373028935013042428801592258970040080466889519055591407045202510060155259151340435100967679237185706539040784806220732414391065738631992850480857299408405005788461238683092993947721981412794835735712271885113485184538896782000612881032355507349142090348803139985057647741049483510012107820583986872489761950435497072449295314969649073928883515886849095177528996620872131033363584351086442435849338088324192118920380581080547227055092773557901089042609716049567617582871676531367244943129510303224117411036362491212185987259408300962972942038332568373593320345135953502460123339612052437867929280220220416431497795529805885635056723080100742271840673465976596388731980152319816381760254979423443779606151831905650447455087461954681797043195632635210093156126197124918119403818727975223618670666671164184320362605400279367493458385475385260739989]


beta_1 = [1997046322950505317749295426660547707885883057505378919121930628898944688555, 
          15784775674383390202002323261771536887252370708138788188564452398537879938073, 
          57122094005576163462148994761579732859583129690587345579201889050663453386352, 
          43888760290841334277740649528694230115334699945194556476478157683684336759651, 
          82684065515854031737638303875987418366711933602625582046920701826953852243434]

beta_2 = [99017941783310181813335054432986774639682772343206650551827676362383514066894, 
          30812137477085247926392877546911891101414049344980958920257310024298429079850, 
          77771936617909057365876557151003795616570314491384499872202932248589034452631, 
          60900365659807399809468509748254300883591081148349447933315272946708870182848, 
          36524487641743539651024360735840166389968107121806123779330829230625943999520] 
pai_enc_beta_1 = []
pai_enc_beta_2 = []
for m in range(len(Mission)):
    pai_enc_beta_1.append(pai.encipher(beta_1[m],paillier_public_key[0],paillier_public_key[1]))
    pai_enc_beta_2.append(pai.encipher(beta_2[m],paillier_public_key[0],paillier_public_key[1]))
C_c_m = []
    
for m in range(len(Mission)):
    tmp_Ccm = 1
    for k in range(len(U_ID)):
        tmp_Ccm = pai.homomorphic_addition(tmp_Ccm,pai.scalar_exponentiation(pai_enc_ck[k],perbed_data[k][m],paillier_public_key[0]),paillier_public_key[0])
    C_c_m.append(pai.homomorphic_addition(tmp_Ccm,pai_enc_beta_1[m],paillier_public_key[0]))
print(C_c_m)

#真值更新预热函数Step Q3
def truth_update_pre():

    #计算ck_weight
    ck_weight = []
    for k in range(len(U_ID)):
        ck_weight.append(ck_Bk_weight[k] - int(math.log2(B / b_k[k])))
    
    #计算WX_m
    WX_m = []
    for m in range(len(Mission)):
        tmp_wxm = 0
        for k in range(len(U_ID)):
            tmp_wxm += perbed_data[k][m] * ck_weight[k]
        WX_m.append(tmp_wxm)
    
    #计算密文C_c_m,C_alpha_m
    beta_1 = []
    beta_2 = []
    for m in range(len(Mission)):
        beta_1.append(random.randint(1,q - 1))
        beta_2.append(random.randint(1,q - 1))
    pai_enc_beta_1 = []
    pai_enc_beta_2 = []
    for m in range(len(Mission)):
        pai_enc_beta_1.append(pai.encipher(beta_1[m],paillier_public_key[0],paillier_public_key[1]))
        pai_enc_beta_2.append(pai.encipher(beta_2[m],paillier_public_key[0],paillier_public_key[1]))
    
    C_c_m = []
    
    for m in range(len(Mission)):
        tmp_Ccm = 1
        for k in range(len(U_ID)):
            tmp_Ccm = pai.homomorphic_addition(tmp_Ccm,pai.scalar_exponentiation(pai_enc_ck[k],perbed_data[k][m],paillier_public_key[0]),paillier_public_key[0])
        C_c_m.append(pai.homomorphic_addition(tmp_Ccm,pai_enc_beta_1[m],paillier_public_key[0]))
        
    
    C_alpha_m = []
    for m in range(len(Mission)):
        tmp_Cam = 1
        for k in range(len(U_ID)):
            tmp_Cam = pai.homomorphic_addition(tmp_Cam,pai.scalar_exponentiation(pai_enc_perb[k][m],ck_weight[k],paillier_public_key[0]),paillier_public_key[0])
        tmp_Cam = pai.homomorphic_addition(tmp_Cam,pai_enc_beta_2[m],paillier_public_key[0])
        C_alpha_m.append(tmp_Cam)
    return ck_weight,WX_m,beta_1,beta_2,C_c_m,C_alpha_m
'''
ck_weight,WX_m,beta_1,beta_2,C_c_m,C_alpha_m = truth_update_pre()
print('ck_weight:\n')
print(ck_weight,'\n')
ck_weight = [86, 187, 14, 200, 83]
print('WX_m:\n')
print(WX_m,'\n')
WX_m = [2267460, 32490, 74670, 37620, 1130880]
print('beta_1:\n')
print(beta_1,'\n')
beta_1 = [1997046322950505317749295426660547707885883057505378919121930628898944688555, 
          15784775674383390202002323261771536887252370708138788188564452398537879938073, 
          57122094005576163462148994761579732859583129690587345579201889050663453386352, 
          43888760290841334277740649528694230115334699945194556476478157683684336759651, 
          82684065515854031737638303875987418366711933602625582046920701826953852243434]

print('beta_2:\n')
print(beta_2,'\n')
beta_2 = [99017941783310181813335054432986774639682772343206650551827676362383514066894, 
          30812137477085247926392877546911891101414049344980958920257310024298429079850, 
          77771936617909057365876557151003795616570314491384499872202932248589034452631, 
          60900365659807399809468509748254300883591081148349447933315272946708870182848, 
          36524487641743539651024360735840166389968107121806123779330829230625943999520] 

print('C_c_m:\n')
print(C_c_m,'\n')
C_c_m = [2532894872844651515458158279466747752259499231114241469515090185712110733517961282581392345142060961610467119415222495900900087880846728533201723730666692912694679878527647598182078012747691500538884321398268571265708193265249612960108299946807999203700573438018874753814465240157607949799194466511638387523608547975413044388067209661219375325242182929384324790389396537235401157117219187091758016762370237624912733463086265481072492732080917704140010873218038564027842905851120508145344523556957667746360804059593763610302343581844272689984853505734334473160979990363147591833593239335075136254277007317884147532751692402607220681007894456878928417251616869163101620072041087582500060637571505832394999580419113390353423338077391688010721134788930164706503366890728087235680348608533808985735985878383690947200859357822867425033845157583463110472648648586766467203800164935871346342310016616907219401224703761886108155774007294224185754702344957455493553001272323904593661030596782364466205481296576267455528078083779947234191985882137943482740481382678587546988113266450778409278206034739135007798838443954629674163351838332678281017900925835864826162054985077406629150867678892254665166995989365825525410978248634917520125887856486736799444202105685740317876702023747092802075174726005216922640558458039293725826707820103875197197022386962372946882405837776706496188258914624173785748870245296676732949410511091450705753177002322108516443584747396432914751491782933505432622185892152284525155257329117295955857419662895271916927873460184067786308303658228912613276460094886847887754311146564755846242400963937668143565735872877958589593893850998320189316617106025251759398914962575722930231367898567981060737375231214945467922581951155521952897210578485074027196251832333313831607934258834184572828816964576511547833116409091791033832419186395468305502230302239796487856525816269404975253296209556684502406975837947935432251945805096329859350731793344133036916605220608666444369618189635336914822244582895625639014106856864652462505819769883669870738869283566808454470793860374308516160240946348897689073719842944106996997139184369191537132414086649896129679672390926746980203374016364712007796838241086210382542502486454178752004705782950800034153790513145114476593396914440557704588300303148163264707925284739485675262574158924719060932238319836514446561704007321124050466153285403188444283740253894482593391213018725007543796694792455020029368857384573973473133398242383121985417643480418528399177923082487085532163945276072621987219332947769171453653801843732480580645261675799654763484645219803837703102851838962533138874213633837191085030711347472523375294234905264835409684023209596855563415439230542339459800213482706492406584250311222347427635479669536311782393937161183340521853518091635980564867268298261228809665152842161166783989123604120587311698353672019791279350077424439876305411838769578697766963572332169741820844102251239611424732356116599587446475261714433223773468735319624052233912649613800993562138727775606331413765558181661888687051118646362093106414951434394167514283947732920445389803413870468253163555397559659789644334454667826813860656461676048847165083553630558680780582687466928592640649618299424144266772143129151589411788817563237704781880834188204583454183499220488475471537435166748848389096447082574860293008267039323162736800924317575915361327898295997884704585901954189039496386221858795096241787362099117007924219124418902281514802945800438073831620503312593517472780785285490741519869049057198189522671781961741905147924123637038397170743037889442212011837115331839862991225945965012533822914928308875868334952488634522637949173631820369091081942893803,
         10275377493875837543230301720663187650021902242900086564003134569379734177473166995668455293418120897882131651812647814277168252225634472225522581547595156831224403334846256544376814558502970232478977350174543114733539088899118993982073110798037385324156225818851150385092622839582321718024907486364530329152171910539213561397331374529120467388021244334084856868558579120549505815662744819449659184290391948028900929808757774291681866800972877056642151843249137013326052469014976685095465436379193631025440835532337291708372708994465915905780140625462284552995077221333100055224130482842709095495511082456045064452554174511575497211107336619146982799339284135774325837506731341091113027068268495671043175644270199513418488523624283667973926440764375064064913264510835296083971887464692908328329572691107607692008083284371905993751260497963230597946715337957141448285330357398250952209426558485785557108713556498774937939394217595963276884662221035015584985747183963856877410073934508995027389404997729217599508165741340971552464824408758034631479745336089247320488687401893580437059167933979681348872213330621175792738727946247628006222073174471944742372971102685709262159936837665589478240977188532677692487810746385664576844072785666948286570808666809875447540872450570987188292257662028389315073024168357701719691700521792291895371980042492344270502471943294326550045940820649157645404726392903298771605991976546814490847298158053118092132061753728932845359813367242251116994502481325301576102951414507506364857804794683337671527202660025129966149110053847047457821713700774890372456845907968909331187956185504584909032298864612201388683561375076252743670675917116491179319580812620384901899392594266315522119822959901056243236430906473181806025309690904451784551085255873618532972510479732590920222173538770989635741409209125648636501851786058832231113078618947173784568513098071122570657416436299399224071082004592480655211908602140850142980698677215285657281892496546864646430480741539466939801860116143985999430516246817207822470684561328264085487233364232718902334417224115025716954823519915241735013302226203540290223446849725736520171991105772448932972377093816106944914414645283681500354892500833518061105066721946134824504628015489176996224913762694144646530393586285904506312473268243365901968553617605304006780738934387468054143529350221146311850964969358020521972632018486257652282571610051474390303010683194435709918406384601085387773335765717718731946989142782681995408171667527805815484749687759523223943256681304665147503306973876065986935787082230913674223642209892245432870872263944248179079360085118263893939234944080128350984112013577297798309196755891981010087972443736092197327546555513302337281595178254825798823683165993913868073648924611142608664889637505510007435594931310038895838377903334165982791172597932212873515411019526256560122548497382726134033934290505083613100591822294293528643330842620453224512647388480283602759786216107451848698445513297413050356341275877874370923347744812976857736301980370508984038770454880748818848545365591256550920924637998030364846927954363888833863035160066726794249063664284916356750942060135853287631226508585694272663630514014525096462345102156049341296095245962231538781040520379280472951363896396761087417444340679058641171948666164683749668145204280570995479479128208289553488549108505363041342286759982684661059555735728439142702975099448313135827393724650212289708117934847605537415573643531132440014689682355820651455083590233788297821991536171877869955006808786205262831123200456247518372618638303592323886590317069198648621460628788029769981218072350468405566680024567599675602605236685357357982604645743453218536118605,
         9571486333673382721739074053748428884341236809687269320322516831650215849274224335870855831404217298090439060407371893301786530631276569359801717460570013459409609476396646404476589910546897250073313769716106328737213291005614605000102439514875136430334369767732474879863050300665213245508703184632832393482054840726628147850450287150284539062364429301780728989934506161924857301827739123459962132497878466520643843684783678480908257039464792292151235791747783059584056852978514753064738415250495889407971824381965311177519764229677737584763465190811391504161393743874378809290313108089648319560622736328752047248822381897161032993131817681577704478818145300205137360045063517867030542907869077342399473376850080809703923278523653297560763027457377437766596854880621205583383921421899923126900495277240937154821082655062308041092872989140082562065600298657858544479779517118747418443403522176218060125051929727471278154738759145091383357260571336164118731588906189028389486339354283822491116872622411750621614606299620467328765642150644506793500460587164702942122409440857446026538412350192798668069289012041576830971182988106550466506250871419231151587981119328441722382504382750994433716674527944442062835333588008207773762645159164191949510888342079809166398192896763519377027427605139459693454562647035146060690245371546123087620485366544274509949881094753252179266643449206671926592679519873418036092138157892830523948043374231298291698942053796239404281697835561102656103053631171535683537519627603632638499464761562758048794231328760490516776439225337787676132525805053184803894373617801120241608054691985566021474020735784210979317153675954616523234050076124994361530655832547255505680979951686801888160317617755306120346706854465081481673621804986201530895366957732271939680422280011044793157500545469538789155385325314276285796708346073636639886974876860371108880734290696614921664294640389992860038728897445791597994579529235501572010512986124976873400380826398703213872187767137348780383954575051317845626331119737851053877720439171370142249993474502546447549287290555320908475968607070629228430248357621662524591621183335207860009071947793090780734599180017313809312455015258100567422697652672791476336630935003452131040612710129701065122386473279613686071050693230703183700352759524807983666436578736689300107806501669653619935778222020007692422224150396623649706975737539327547659822623119864962157773140997300574162303274946461036607926884805025778921386258230954998523686688802106357026991172619344528280950239839109530400578174292491305007134060257431434952119468398794667397519252090177796669300591581554622131574212434031877737336260422207169858232529183436753325380603890355892753736460660844075181502864279667814409155819937719176614660195105047436984815727078169363492139993921290298843698003525358003657540659827810688523299095542080057283310798911664252430527890351841878988769176678372674549831480298298759626281209272171239858047125423344606788745722270219151887936423223333186665020921109798526420096910827430057075907648428527610341756042475459074947664671229126134699347257578982428987598919198359442017606347977959386525219496242113589088857076051811386404170160811067410101556622254403778209889333523770716943696006724659293813776210930800263730731945465556859529101770603856402985245905687052267241701831292520584628957928331121223598180097969404134876083891032853412823542572665763543336317140445753507244129798979253739841317819281587439023516924401555531361318187513300835203807937049814472423487135166433045038247795142141481289710503130212442657146211761346583691912503538882052775411213507592608224296662124138134296550696437013435614984391358768972004912935,
         9806841284559212685795864615042125045394158176060876055857357995949009304621635225438349697348567510278431688153967383402058263344787796046945015323779309582650403210099203094217076999366143710046731375678473968197330508675303045599990443063283653837666060866211476091549680670841028414203774458874920154463470937810881928996285850392337608531555261555711131880818963065687534908716454443286124085258549018050220435202085042871165213122108348468040156645458177842094698791943446106155113282297110266809200922932799976096101986544991658420098534680821731519976520914840172753666670491568962035986401766641977487413565878577051039358128767467291915542459260940536671697110883488207089328246928824516288296264070496468138413885359697196859395542082317566317634540437226601880927608353762249204470176047803821867059847027184064126349762900090957590507061763729573664702344135187425381461319661474386683207830986413111011901020710818461129687053316555531634366404757827777982510131159610853506845633113092731049142732326509381289726432187091560755891308839252457524125121295729777889749928669444901259084426460356183023355512813772873379074051551813332682370534467889627037115660253966688832585923391121081517646904550567904238212273600377368664813271338909354592959917147153972410209907754552759173633458983708859187086920310911328712298206968313002027595150200807023249816248559381718937686355226845213989440048078890321289254265811140560913237362822889625707494322204278899263110013648118590233187418072565002920297624915903902173281834188839339903199251346956912839658758975183514229239565171916547907591689237930138706507910406953898908254593049123177945653270714469979171557431447190721689903669434760116865104529504110268868395565322826159824229787805720573143184699318917937411832519651806705784325800964449166787234626678293071935624195183508136506603630447731482311090598148632288698603023319264082945006027787515177770567359387857279671051859647901625938562380333268355616351311036088229861783841053668310395437903555816729118309175304057517972778522770566306115544272505941041554647001986141745838636914215851122694675524411662960330639349914033535495830769402010005776437128263256875520634262970409378873617095233716408605423175860286628382719011839796332878021051407423360594336577775779531285500307281387824541509118797518004681882118564834897359690064485869064661751447089001190823179268638337062667671824502947098496619537253690399262622871717421689712982726793881859993653604111229252530350052203092702467341320784419636352707223976967533600894893660469254907605357667944779012708364436515921976118706944419426035871241267395833165959403712071472491312912367278171917409812145955658945842991678956867150731939229979520543862163211672743736457931664806253684004839857815206120892902279708251781456127289016685140836693927467036355985830844278480680224710695885245866750256790197177281104849819542798200871670232835351392455556027808352801558691477092337174886474212651034931138496377602785000705319548100435779572020750500677956524600590505337235527757156594846565456412055840937305887486982796977154857180045711303506724330883096038821535490001424248117408727281415029088428481645755836045943738235602404639011012772376943435704942757439895393334496717484614945068832735879581346824847813293953067787794901618345779870167900639708008324809975363567825884798578846963407149300564428874375813609754768421799251472848302299940776760490223529364572272742433180115925580193911864004500575119580264305418416219045563174788420955576657641907124755588463615698547945432055517404042119906061458628636757543151484275781115062544889463134902079458978373955292431759213255301128549237455227596854,
         7872154688150697732195069589137836050133048779627967262582936575657512008054190178260740821841948447143564520110025342365803336356089236712786694346502921168771108619906515201958243064544407052670787274437277650138752056055896797892218782978625928186369224992329399770553495852792761820194631962793555947514076184383422652973091543409155937213586733311435277269021526528670471848740543208379928782899041455265638086518186732592574797782955807853686242890347595967863625246776172408680541598187458789068636710847835954389056655488151201349270648464641319001005783985960907331371560024899986197175279373327468846704080746331933125830933946850288439432363135108003865847216113079297203100581822894582925049096966411229372401217318244830574126695493420557973755142459250199370127027698756537073719996728605389107813316132656092718158746819699057617633584379725894620332474758861770132561865482742410744203687566535402433777883482169903107391239478237481920265449337483273892837127206597308448582804495952370255232479215520957679218609321104796367836067557131876321680029482754918747647907676247399469148951989606681586844395536014095962150780374263903669665617115808544249292129141528975950911320606855634965557978819337875188337626805579901873550246007426572948537433744810949943989267217523132801652812128619999743977320453714639044309628108310289913575645981274604951935269003680252735769338712569173169469549483299569008453409691489840642164422566567643871831171673928316814069426756860900220218919179743943250521095122873905015579243752270396501477678951515915577141278514871006708441173830637313112601088316038739791988576443475630406389484111564135339324764225784938244118730007128570956270014331578941681398109971947088593322878905390121367418872945835620913960222647292511734416642350478482452168666708365922333772756593514272405189713561644544023130969048183633381826168059986674161011622016852233744116043924573962893910921401056743749840746071066397215070151432900748440876200745472813521313806783122669389047128288023774998400468227433643268152882884522549572243883607985031843129347573182160665315736151894624981905864218626937600631975981270263402012649124090561164665679454270533701029220431733974417827079636146028602480295295319622899547184367460532227719169454282361820980931349022954282170351914554291804501138556012954721002263448412222048391293362549530096289974162392492731084697480026384724630412887499597254870563966089911183056042425378528878586455463131305550371645375970628439172710738869314754662743896242325533672204144495327481104918103632835440426087590821223301375011331800759251952482038674885911898692144121357526946609536548440618655966615242891466892000973541389070275629300597350783103997026748718313859692720344723165307344137143405268596902943174988075186189283541147817309634396928801199207709681735165607734882819872943583363767221770476955368337613852621316044995809713603965401927080856991721697289321034112279481377547309719451212440310356803860311375381763245034441558882977224175028467653210954898576480765113462505762246774980360639295039277503655802984460702848020907403671850833796310103481752783530003212486652542362456608078819153891995591384098860868395366578950429245828168973649777498538735029073500816719775788787599393909596508441999930798836330505638780942142724571522984547304701158538750059649470990710356337503257322606809260021875655934746031105921807129417570788746650043839705754133556644412071749595311321303232884883590521749113229119545077685455464077691250245796532740010295552584257296320066453836178141848152260613639352460299418062221939873525958038208134235265283372491290697751273006413188734590171127168954158390614913688218737]
print('C_alpha_m:\n')
print(C_alpha_m,'\n')
C_alpha_m = [1178075819880611083553820119575615085175668174475137445781534735201586291468480092827805310514442889673901637833693964913731068669296127252598104212255397386747611945710192619950741659147081595251001071132306471408497035356457967300598172765901528579065501876748202512753689584439165852690915654833983231954864755353808588606290577159919711896673734591648108370246723717742791380088090722650891003111738059173198637283519746383691494117410439486771906706028911510124632294192333498850182715111590278850418762796458131556916797485592466418196707840108399553927267671278341504760505204126938955303825370438355125114000858715145156510400331470132437334010556314057622063185254594951162133956091051465200168806398852718576271928327734239823602144213737131711888805011361060453901395455901693996195168146252232121224405765768126213861179606878781170203134196348882674915363569646686042855733798437155937348552250106278718535394770496855766510679941551276294061357664507298618998502588080063128020454960316403334577259878831854093660417389379953021235228400212144051015971802041302142384187550130153551750533753074944835931162303829835042534392455750823458504129715778683385487801587918601422237875437322678972243708173859677735319567931671654628464594700176706737951030347805758458948188046786060750474455303396050757858231959616794226792389004518490359513703565379894993262920686137904385969283710240182473846727893518993461375824361569925148694707549117791612654093056093097640536745088632653074224218581948829658959585942048858316195965732888843308256701215028167128068565377601494657612560560494615353565526486831707565588786846438802526677827206572412175709779070603376563088515099513877339142573053229711137851613447185548511708167421222675162223527855378338203994819904656177605226545337318388565532663776703132859165363707631062349747863781125278791244176490595967762572270159412990353826482422060406628650130301610464290264052567434136090207497636475136216769814675001445564889746184299847824312413280490094593833423976587827447705470896160878842837889917816009120887224421876846777776044181145589254367025692396122029660221980698813961878232905890148872361348419601161299691083960216995794384498229366735954855705157827619264973943915231305896461624613337241674021513524035045280456443652400878886354173884296147171581674117609341111300093679783738522011379981835811274515801166210282559397264680434080900737811398196105961677107760227638257623825697863042028142399959127671720175626673970423607579505928547163066248938279246891980704969081850124086816499911417904153542339723340732172172230449549288479224794440417675931309880728710746772054233293071276901215511703577673273766894986938221884955738941954033165923227215469235428715369040385465820133361937475762939015816763151236669630853849413712985509749081311006456890175573245590270717229174275306682602037128060495598789111765131517818236810247216695519727782577139725744267081603619801798889766147682354572892791662341600850941927564230154132346018210954399012919076823815226967959511972875017594450211177080514681700649916353564552476205517809664309805313208422088287003204996233570335602619017156297217788507362483955395951685028104923081783628957867524512220694125548540456430825099996394177718517199141131400947190561579215943607710265844531501852070176006644505189664431581017255612404795243598796845598558493378075427725758412847244356319069997335253495265705997411145400673821381896798277449417610994467409310591766538012996563096719148412947957536185347402133371496784692397039166969775121906141243804361124583973852762261205080545586092275269489509034070106293263265707326399389873696890231976576229535407186301832403834882079,
             5293452741337872144963485429969658022171823722227766798398800582004718846607694373825208497690525620911507097636505601661635208321141004864766395391294071183357237488363858569501482717695060099410172749465387237867789391993624229270679382240596284991060053135105576756621001516505637605239082967393758160876215379397559666387096884297565559134031852238363977432371927113024136992977672123118030802449733368553105338182614638249995388218776097275182698049846843822137135068837403768436470773862794716029395446245645918651717691293808845810034431465153098301916456179745613208564080101490611814287001630880410658174285236267594585496229350031656229301988176584764567379277071791309925516125012624664541688200712822717517310108571852144768983151182531064647557853582091658520418070707379773412038543712580297055897495702971918270242241132870129628378666970160044633650687583356122899160300631107556420778438252790145322354442482394906525449853211014807733845489980938631312742256729319441291605469257825217459901658106347139055880942575362732386229978149729725736768181468851071478162147323904485726732730802991051537306521734787558579914572076665773010820345094863617282522345523967995468714520130632464274790819278468391813867549146329577967578469442553522581809669278443194097886593789210040809900227522053413544379524752628780852605411754539994626508941066009281625840422248371598827609442630266509875485692111699114322553070893821653169421847330030900318849990217186497335107154903055960515005240876534222909870426557573007039668416827637172711930533329329414657400351130206346622488347849226481836073833046853697864383723153465491923305486558376035140264745810819089838964524740961900008415089823691470537974443789208146339905514295119157038033105125706614720200008965498090305949670898814783289313576102233547502089176553047622408488872567547244844878304296694825485249953503396065688272745642557631456628916451965080959912560336691644441173742306322564552283184637950783754608827475861946356057221001186258190087602039684040988122261566999107897428626264553194836422016804095604487209829134721798179985694114203145442459681755502915707316346141883046899476883487272398701164509515424355438309114392111190720605714548912017038781799179833275753309716334311121688341735673298956802074267604676282058276630116558578587136371538825816268757770316494917098658693688272272211824304336704273697215223815341281021676472174271811997889466468228897083010510399663835715512320031383108462272765173418229503068594969119057264596989234867760295471512746936872393759117780117335351683024473673663464341777946719704787779771472860439885346022595514301324844312898681900745386768074830234882254418821484925394085906022432486492782043289695263881548079560940248977355011407588563616599589898749069722388175742011422585148647098860175352548697194124958736640728922264771761437506487280754513824818578908220016547907011824061179409511175853868576551776035208649624635620142888133782347925183268296041702512306284301516031450863654283227059445652204364258349101860079843440238149084833354017765938273122951397942997913151471879006770559732174022756267075854739798481795993968841167314854436465952484357218942885076218383026719533711590210641971228184296296310646793524144901928541774982972242397716504924955919191228670404727752819800529648795165045376258116362080983854260795159684365367423322100977497312585979888540786992377097794761232076606031712566884178359293844876162718337927693134174079926798244405611782801898842708355699763563321943218059670551948637938406978811086233819151853648363695981574486113394315751957174183530440766700974622830673088752726012543961303582478893019704237185703007935311900202,
             6016898043822328716014558763666481737723636855278342574892809953781371157957384503350201386352566659488998582756007449244935042641298371074831943546597090865967334163487223531529259797933762320512869497235708179534203203631326185024849015375203369534071874737987941042182379266286226083727623423713412991897168858815471205589075538057664724067317722453582351890390227417020850465012693827118129607514743521711822086151965193282405465825545808592052485889804050741842057512451272298793126087686885600418346078116053366097187200790318669562270686260226386793175147357631919084088248464317170585463888065348768842380312306099395343312062269614107996358087183502480622845708531444253759590853194976656269463404735973657367295428793320259531359726144350908364663106310674280549219579063139529164237631581638449932095890978768163801150956591950599547427795536260238276202767885671530064958703602711795914806879259091897582063321829125811127005966270116302982621569816714552036630006140276335059190101150822748642140459485319017267697774970999999668983917822046462445416582718130313216610070889245790466567606512333916884262682917186930489033846633280494360995379724276436935572146844102762786506956914416144299338160515910353862563444958743018564716756865105507133058163207501154560604300297483927574566813408133019167841159442051479985408403359082831143763231594488476782342758645991123424585528179148477937723248005442956171816588106642546799813878691884154810929289898724394176954741634336090282997601525205779039880301974705425555458563507676763047386015257891422073885895781825248907794768407759080536259459787158613338972929717538576442895266934344429403668367250893961010568531993215951525106782422333630172778470910403274754548885431385725922724157351477902483402182235077797825044905813006062271286921301466485258261137589715160463016732009953065945678160966340081122262665092086945505515413367269028545889434450799187264976177370482871202703305926835650060855754495705547767671456581913388392053405189550666211021609731373099753187671524987818300288983404342811756666490444142294439995454033525439335491662392524790986532757017640812313539761259824349326671630113483128544721084023546549142955642638404934361008502843586826330951875788113253668386751814384802345006951523318675321178266801759192091754573175322167057399715562793596952524078432951409353235489513452521642932389442388417199310394506051720884995812849576877205958414061685145200353912300086499285294892804175452368338007980651586345231213723425385188110895634225827023228983200934821978182105569081835904003322805199145927509552230074429516627169754367775504334031443868360283120628983553143423753260444598363973692233804733341565476876167880509485998930740055955078328569813420634079300595035897840835737262544066349814205847869350620337922932174859713714634625788433137566154103744561448665230039039364352210315948959296356870019294833101600784107290883392243967881635393161365700992506424346136838429081991548860658087955418925847141631329985627800646024781563088048970039875685397768901425903194508681369365651002426935385874925970231205724299018289403675450669723116744106540292775173135317812911897300486875813694643022242791142427406964182376733172223419737763446845485835727785086841744851243156063371574239619836227812603692220529893809067905452659617761185853849314905936573538850441199881262886696304316041627880102601238000009976168174340325312609194850155376025811463064590780265493176369961486798655775797245640461447927379442810035439367602153782890771850534018816042299821464529737286481287824122305389391646937457489650880179716586251230979946933788604528682212758717909189476995052832055653569091060465846119296,
             4999777764770618456604514381469644199654356105383488628828418428357530216783646917323716418131076719458467698660926594877937538386939356461409172217514247266342430123361510343600406647983056433501240209417779362298918159260129619845347522717239659955251287965094696165188007997128071465141020557528177970420770467454406947697474550205855750526454094276794224266341189485414383870817337101662658709178797245542403604136475868814636289532224415295665969149873629397016542729149727503470422980393860098723239022348080830491299477181268172087510412943464663710886080891594980809898363424641662102138099735006115895503169195676371176999211549971405595893707319145715472945540012554353671623300985629619363648346713972951912244339465883993427641888633077377838990959329758023446111405108733920882996010363554920393017331878213406790567966891839525700187800450761435292572718238175459790518485385291321181911754314269557876687981548377557200533455976912883649182847387999122201488033609087201317566913847835167585537176322426634133337293245646107638962989799228996599823066302702698725738252926441338154244612467286350634322684866790671761491807470663004474458198650160579976415912577457106719268958737820268356598679476443452546849837917007209026818022905665656055314068881654418941159131296670840626288254066412534611735380912292973686091300823092439371905592582297365920836403127352957255591266049651625388638891082685217328036839912737243450718376894936015391505956176312005420376039807586083586891672520526564158133535646329692960266337753982589109127885394057495287781288183218675200254652081963946928317367582196349574193955459816195951380463747798828463979421250558519043466097378754425909035817379428840119722650066509612603417853932274191778301498860385766826329581600626990950126526666370550354310967544844131388097723779872093530240094893821469657955889562295114000819258565957497055944300526823629274380506182238745319046952398395126659968715114537501692777315639843778197250596383371135658041251393830996231423680453948596172418323179103039853003154940419857026737963764728580657129408307107275171220256941119127274323477844062581017329793536290647299717642707239628530072210683779775911153575470398229601433342259187931875804059888511632311055069252528162474828405869656520545019029349297726405075121234137220574401307846559244234962455320024907942521717689677897732599009813999968777685457148645070288461763682158006297125178664192581196423145553390697325472704319113330216079384985044053416522860899876935112392962533911289847169769773121729039840381403413891354141069384081461615456401306628661098542349912853952263609653341631513859097481717270052068857649368618742934106254297969190077556654020333491084510587226832716810678466055722917409762793063578879653597070263746947596529399584881254783270851111489297768771564782818148088124127571399058570690102786723698317009667680644571850971546247106917419275267660240792796708902419240139873053203974181221901636653010683093645055926569552480544785761526443446686834986909914560942136314449357673936216660225606250452166634520060300080648190935290654052751216385132445250327772097877687860939591091038153189928814911890867838196838842934155043533616301771172382523426723958799896925431337104543386861396673348476136945820168572695207710479765356270736485454617402457196107256226285076635285686768284995990635204102129163623560585282230729809110710720388377600712275708607036693569041477028885530995610453189603945993030700263525784111798504535043428187949117786881955888335767705160039726403139757701316939222319112028842436467162204647880668784502788839410683808933245159236897182655631123620733615598511890077406728614576052113856455673,
             4239948581684028745764901597844761277261712258452386933700548993332596449659324898263312228178744061312112370192572545134830483843001253160946080938712804557390097757037715534433893092703590952888842995798858095539868782830819573003794726118210159233139971845928371396726151979709667551389039725364823751601336899631475374967608369860048677178974877956206799653027275009820645290166908675068502951678636122431313696768240257382461420284517207000941678182494847866535706018050964887940585717360501527304154866989162426990567854802133280059515297784863083186329594403632124314392113662884525377350883300872171370382968331003085316482683368881149742073906875205135467913959172169799034798738318918503315383372592179512013416362414358353001857967569602805501068506618575021817282397279831979679788101966277539709260332152740171893168075820726729333879998451949422125179879204608027413282941667934586122849485429830556981141226318704048653698335209459335498232053064227654015566206915271700433621062699472015540373760574230631708063633231871570529835098000967939823966191795969344263997050671124055019123234529142489716888484563494953917077929483212247216496841109639616806103453729773567329906920291247981126135918204344900212596059792810366513917093547041482535724496066654144937433421121338829557568082599070324945523797939589071739618614735105256181975395879004840918047386372748735528899006992882002325656819169426371610571701927459006327573414905870929683657371488431549121487436886177238991599768184542605011878772470699425985382163314909811465233186014812691665649187822553751460662146394354305066582684473220469131835623586822254638286724412537512635646786347798018529495043557644268146395470296172736468759074413917746946557829666674332221827530477055636906171944619895590800381599875396209500178210051144908833076809730307479164008572051244663266950678692982115612769586670882809601837394083133474546504117271617089691803516944685311820326714937155587649231758774260935992173769402141413892617158987285153029181434213796234475613081203565862459574201401662765051594286389520854616276690274602766421157082028015253213998417368469130365353617571486103616843522287266489985324599442047523858492251357177511065564481631407870366048727695654743314580635561692763427097566530646930305295831507191120467600903829436549649679050247242514361156129133697466397495279393581711248624787706453166264865183587430788962625509565835464401876898235466727447120157162821344183040517664162618991287013145298613529063267464868580359824973297097085373452747552396228645740567030138393222125198219114489408673063130349459095652544360377559829989958523563916425997729305559539714273462993808550341883953564663640071306572631614705324064495031675111921970727335772276235035886615017505907119124976244304351314517580661084867308971836203952417750721702062863901760480157777552178651454144157202166017276022335411250066925930200150841138938064336857307790496453767823584441046087680317248246990267670630058684683306254165713636120302541552977524274496436300771276670236349401218383485159323980363813994445774614306743958859201259909321357214647177145365477107970800343165833255049076357286960307996924419811672825679028019021971361872007270991029694643060134652355768045715072898608600054218909296181041816577935937853238794635823602924935858986318733914329201133135534684631149671270331018317924661294969328526583145161522280807573186776465512082291376678116000851095583288627171048834947693002585075567230901510328120731303893120893839279553150759316605193162547731134260873676384016757959192343559570502977870250309136642396040561218700525181386596216110507472201243948933704345799956422842894777976818025410233283]
'''

ck_weight = [86, 187, 14, 200, 83]
WX_m = [2267460, 32490, 74670, 37620, 1130880]
beta_1 = [99017941783310181813335054432986774639682772343206650551827676362383514066894, 
          30812137477085247926392877546911891101414049344980958920257310024298429079850, 
          77771936617909057365876557151003795616570314491384499872202932248589034452631, 
          60900365659807399809468509748254300883591081148349447933315272946708870182848, 
          36524487641743539651024360735840166389968107121806123779330829230625943999520]
beta_2 = [99017941783310181813335054432986774639682772343206650551827676362383514066894, 
          30812137477085247926392877546911891101414049344980958920257310024298429079850, 
          77771936617909057365876557151003795616570314491384499872202932248589034452631, 
          60900365659807399809468509748254300883591081148349447933315272946708870182848, 
          36524487641743539651024360735840166389968107121806123779330829230625943999520] 

sum_rand_m = [-97020895460359676495585759006326226931796889285701271632705745733484567166508,
              -15027361802701857724390554285140354214161678636842170731692857625760549147775,
              -20649842612332893903727562389424062756987184800797154293001043197925581016786,
              -17011605368966065531727860219560070768256381203154891456837115263024533391394,
              46159577874110492086613943140147251976743826480819458267589872596327909344489]
sum_ck = 559
#print(1361780310252957488802051640278329977730094384108034403294749917356621560864955280503145585381570253133746598650953651251114220164965244842560258187451684075312349823918260620047502802851041240017969089957798991601022098438299123801852303792610732445413760108691750549458832559933220008671266982038292482552040988014038618062485530581687251186964330865919090876636648615769780785369644876099974822203156424229450150991684621015197141836149269074803600812878637170791093389312717155515415872103302857950443833165721994008589174286284510701547118260124660251415218495984572104954153194254789491909184934017871832419374540469977568075524466790035499059783148202438571580421607990269371005135217892768181681031492088192224432754239475383602444057125677183472641959148014291865118311706568609215135137175989244233045416384464698009639478114980899664798562444444757140290818417062917754871319241419676653684830255113113259750347634807702444750850796388270546431181052923032039989949312522481070573278345164141535945530917602556584289931417946349197780808604654589131655050223774099789455570799061579291305799774237267089241852076320813477410058364894019369461475603852894096720693686730415860581413094073772442745124923028507072318235386032141277038126341365775254445170171493465391013565800380492516128692100266723436193172952456060708937363502126242153977327412357993913735717514398794168578316555816217185527791537137045725752586833078671786436118073675589977963626549113502893265538485855495831710926636150687839468254651009836031232789573722694192213225306038519986070760811298858485900840650088522673591983252873938083604313041803658791745721928754732379164963833333895311505616885793921119151832573371195510240804540731418438525489832120948589388079318203752779877473018442045307942741651667117400201218189072060331245618062065222693950686617501192-beta_2[4])
X_up = []

'''
#真值更新
def truth_update():
    #先计算ck_weight的和
    sum_ck_weight = 0
    for k in range(len(U_ID)):
        sum_ck_weight += ck_weight[k]
    
    fenmu = sum_ck_weight - sum_ck
    #更新真值
    for m in range(len(Mission)):
        fenzi = WX_m[m] - sum_rand_m[m] + beta_1[m] - beta_2[m]
        X_up.append(fenzi / fenmu)
    print(X_up)
truth_update()
'''